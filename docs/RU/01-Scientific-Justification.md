# Научно-техническое обоснование и требования к перспективному DSL нового поколения для описания машин состояний

## Аннотация

В работе обосновывается необходимость разработки специализированного декларативного языка (DSL) нового поколения для формального описания машин состояний, 
ориентированного на применение во встроенных системах и промышленной автоматизации. 
Проведен анализ существующих решений (UML Statecharts, SCXML, PlantUML, XState, StateSmith и др.), выявлены их ограничения с точки зрения детерминизма, 
формальной семантики, ресурсной предсказуемости и интеграции в embedded-среду. 
Сформулированы требования к перспективной спецификации, обеспечивающей строгую модель исполнения, статический анализ, симуляцию, 
отладку и детерминированную генерацию кода для микроконтроллеров.

Ключевые слова: конечные автоматы, DSL, embedded-системы, формальная семантика, генерация кода, иерархические автоматы.

---

## 1. Введение

Конечные автоматы являются фундаментальной моделью описания дискретного поведения систем управления, протоколов, производственных линий и встроенных устройств. 
Несмотря на широкое применение, практическая реализация автоматов в embedded-среде зачастую выполняется вручную, посредством императивного кода, 
что приводит к снижению предсказуемости поведения, усложнению сопровождения и повышенному риску логических ошибок.

Существующие графические нотации и инструменты моделирования не обеспечивают строгую формальную семантику исполнения и не ориентированы на генерацию компактного, 
детерминированного кода для микроконтроллеров. 
В связи с этим возникает необходимость разработки специализированного DSL, предназначенного для формального, однозначного и воспроизводимого описания автоматных моделей.

---

## 2. Анализ существующих решений

### 2.1 UML Statecharts

UML предоставляет визуальную нотацию для описания автоматов, однако не задаёт строгую модель исполнения. 
Различные инструменты интерпретируют диаграммы по-разному, что делает невозможным гарантировать детерминированное поведение при автоматической генерации кода.

### 2.2 PlantUML и аналогичные форматы

PlantUML и подобные текстовые нотации предназначены для визуализации диаграмм, но не являются исполняемой спецификацией. 
В них отсутствуют формализованные правила обработки событий, очередей и таймеров.

### 2.3 SCXML

SCXML является формальным стандартом, однако ориентирован на более сложные программные среды. 
Он избыточен для задач встроенных систем и не оптимизирован под ограничения памяти и производительности.

### 2.4 Современные DSL (XState, StateSmith)

Некоторые инструменты предлагают собственные DSL, однако:

- отсутствует строгий контракт детерминизма;
- не обеспечивается ресурсная модель embedded-среды;
- отсутствует единая интегрированная среда симуляции и генерации.

Таким образом, существующие решения либо ориентированы на визуализацию, либо на высокоуровневые среды исполнения, 
либо не обладают формальной строгостью, необходимой для промышленного применения.

---

## 3. Проблематика

На основании проведённого анализа выделены следующие ключевые проблемы:

1. Отсутствие строгой формальной семантики исполнения.
2. Неопределённость правил выбора переходов при конфликтах.
3. Отсутствие явной модели обработки событий и очередей.
4. Недостаточная поддержка таймеров как элементов модели.
5. Отсутствие встроенных средств статического анализа.
6. Недостаточная интеграция с embedded-toolchains.
7. Отсутствие средств воспроизводимой симуляции и трассировки.

---

## 4. Требования к перспективному DSL

### 4.1 Формальная семантика

DSL должен определять:

- порядок выполнения guard, exit, transition и entry действий;
- правила разрешения конфликтов переходов;
- иерархическую модель состояний;
- детерминированную обработку событий;
- модель очереди событий;
- таймеры как генерацию событий.

### 4.2 Типизация и модель данных

- Явное описание структуры контекста.
- Типизированные события и полезная нагрузка.
- Ограничения, совместимые с embedded-архитектурами.

### 4.3 Статический анализ

- Обнаружение недостижимых состояний.
- Выявление nondeterminism.
- Проверка ограничений целевой платформы.
- Анализ циклов без задержки.

### 4.4 Генерация кода

- Детерминированный output.
- Поддержка нескольких стратегий (switch-based, table-driven).
- Профили ограничений памяти.
- Отсутствие динамического выделения памяти по умолчанию.

### 4.5 Инструментальная поддержка

- Визуальный редактор.
- Интеграция с VS Code.
- Пошаговая симуляция.
- Трассировка исполнения.
- Replay-механизм.

---

## 5. Заключение

Проведённый анализ показывает отсутствие комплексного open-source решения, объединяющего формальную спецификацию DSL, 
строгую семантику исполнения, средства анализа и детерминированную генерацию кода для встроенных систем. 
Разработка перспективного DSL нового поколения позволяет закрыть данный пробел и создать основу для промышленно применимой автоматной платформы.
